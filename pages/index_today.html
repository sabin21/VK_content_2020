<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Visit Korea</title>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0 user-scalable=no">
  <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico" />
  <link rel="stylesheet" type="text/css" href="../libs/styles/common.css" />
  <link rel="stylesheet" type="text/css" href="../libs/styles/vk_theme_common.css">
  <link rel="stylesheet" type="text/css" href="../libs/styles/today.css" />
</head>

<body>
	
    <header class="vk-header">
        <a href="../index.html"></a>
      </header>

    <div class="wrapper">
        <div class="today-logo">
            <img src="../img/today/today_logo.png">
        </div>
    <header class="header" data-active="1">
        <div class="header__left">
        <div class="number">
            <div class="slide" data-slide="1"></div>
            <div class="slide" data-slide="2"></div>
            <div class="slide" data-slide="3"></div>
            <div class="slide" data-slide="4"></div>
        </div>
        <div class="title">
            <div class="slide" data-slide="1">
            <div class="title__super">Night Travel</div>
            <div class="title__big">
                <span>Yeosu</span>
                <span>Marintime</span>
                <span>Cable Car</span>
                <span>at Night</span>
            </div>
            </div>
            <div class="slide" data-slide="2">
                <div class="title__super">Street Food</div>
                <div class="title__big">
                    <span>Gwangjang</span>
                    <span>Market</span>
                    <span>Street</span>
                    <span>Foods</span>
                </div>
            </div>
            <div class="slide" data-slide="3">
                <div class="title__super">Cuisine & Wine</div>
                <div class="title__big">
                    <span>Jeonju</span>
                    <span>Makgeoli</span>
                    <span>Street</span>
                </div>
            </div>
        </div>
        <div class="content">
            <div class="slide" data-slide="1">
                <div class="content__blurb">
                    Yeosu Maritime Cable Car is the first of its kind in Korea, connecting Dolsan Island and the mainland over the ocean. 
                    Passengers can choose between the standard cabins and crystal cabins.
                    crystal cabins allow passengers to observe the ocean below ones feet, 
                    experiencing the thrill of being suspended in mid-air through its transparent flooring.
                    <p class="sub-title">Address</p>
                    <p class="desc">3600-1, Dolsan-ro, Yeosu-si, Jeollanam-do</p>
                </div>
                
            </div>
            <div class="slide" data-slide="2">
                <div class="content__blurb">
                    Gwangjang Market was the first permanent market in Korea and continues to 
                    thrive as a popular tourist destination today. The second floor of the 
                    market is filled with silk, satin, and linen bed-sheet stores, 
                    which are the largest and most famous in Seoul.
                    
                    <p class="sub-title">Address</p>
                    <p class="desc">4, Jong-ro 50-gil, Jongno-gu, Seoul</p>
                </div>    
            </div>
            <div class="slide" data-slide="3">
                <div class="content__blurb">
                    It is a Makgeolli house in an alley of Jeonju Market. On a rainy day, 
                    Koreans think of 'pajeon makgeolli in rice wine'. I'll be waiting.
                    <p class="sub-title">Location</p>
                    <p class="desc">Nambu market, Jeonju-si, Jeollabuk-do</p>
                    <p class="sub-title">Cuisine & Wine</p>
                    <p class="desc">Makgeolli, Seafood Pajeon</p>
                    <p class="sub-title">Address</p>
                    <p class="desc">14 Nambu Market-gil, Jeonju</p>
                </div>    
            </div>
        </div>
        </div>
        <div class="header__right">
        <div class="video">
            <div class="video__left">
            <div class="slide" data-slide="1">
                <video class="video__one" src="../video/yeosu_cable.mp4" muted loop></video>
            </div>
            <div class="slide" data-slide="2">
                <video class="video__one" src="../video/market.mp4" muted loop></video>
            </div>
            <div class="slide" data-slide="3">
                <video class="video__one" src="../video/jeonju_final.mp4" muted loop></video>
            </div>            
        </div>
        <div class="controls">
            <div class="controls__prev"></div>
            <div class="controls__indicator"><span>1</span> / 50</div>
            <div class="controls__next"></div>
        </div>
        </div>
    </header>

    <div class="contents-wrap">
        <img src="../img/today/con_1.png">
        <span class="divide-line"></span>
        <img src="../img/today/con_2.png">
        <div class="video-wrap" id="video-1"></div>
        <img src="../img/today/content_1_1.png">
        <div class="spacer"></div>
    </div>

    

</div><!-- wrapper end -->
<div class="video-view-wrap">
    <video src="../video/today_final.mp4" loop id="ask-video"></video>
</div>
<div class="vk-footer"></div>


<script src="../libs/jquery/jquery-3.4.1.min.js"></script>
<script src="../libs/gsap/gsap.min.js"></script>
<script src="../libs/threejs/three.min.js"></script>
<script src="../libs/aos/aos.js"></script>

<script>

    $('#video-1').on('click', function(){
      $('.video-view-wrap').css('display','block');
      $('#ask-video').get(0).play();
      $('body').css('overflow-y','hidden');
      event.preventDefault();
    });
    $('.video-view-wrap').on('click', function(){
      $('.video-view-wrap').css('display','none');
      $('#ask-video').get(0).pause();
      $('#ask-video').get(0).currentTime = 0;
      $('body').css('overflow-y','scroll');
      event.preventDefault();
    });

    $(document).ready(init());

    var active = 0;
    var count = 3;

    function init(){
        $('video')[0].addEventListener('loadeddata', function(){
            $('.controls__next').click(nextSlide);
            $('.controls__prev').click(prevSlide);
            $('body').addClass('is-loaded');
            setTimeout(function(){
                goToSlide(1);	
            },300);
        })
    }

    function nextSlide(){
        var next = active + 1;
        if (next > count){
            next = 1;
        }
        goToSlide(next);
    }

    function prevSlide(){
        prev = active - 1;
        if (prev < 1 ){
            prev = count;
        }
        goToSlide(prev);
    }

    function goToSlide(number){
        $('.slide').removeClass('was-active');
        $('.slide[data-slide='+active+']').addClass('was-active');
        stopVideo($('.slide.is-active'));
        active = number;
        $('.slide').removeClass('is-active');
        startVideo($('.slide[data-slide='+number+']'));
        setTimeout(function(){
            $('.slide[data-slide='+number+']').addClass('is-active');	
        },10)
        $('.controls__indicator span').html(active);
        $('.header').attr('data-active', active);
    }

    function stopVideo($slide){
        withVideo($slide.find('video'),function(video){ 
            video.pause();
        })
    }

    function startVideo($slide){
        initVideos($slide.find('.video__one'), $slide.find('.video__two'), $slide);
    }

    function initVideos($primary, $slide){
        //withVideo($secondary,function(video){ 
        //	video.currentTime = 0;
        //	video.style.zIndex = 0;
        //	video.style.display = 'none';
        //})	
        withVideo($primary,function(video){ 
            video.currentTime = 0;
            video.style.zIndex = 1;
            video.style.display = 'block';
            video.play();	
            var loop = setTimeout(function(){
                if ($slide.hasClass('is-active')){
                    fadeVideos($primary, $slide);
                } else {
                    console.log('didnt loop')
                }
                clearTimeout(loop);
            }, 7000);
        })
    }


    function fadeVideos($primary, $slide){
        	
        withVideo($primary,function(video){ 
            video.currentTime = 0;
            video.style.zIndex = 0;
            video.style.display = 'block';
            video.play();
            var loop = setTimeout(function(){
                if ($slide.hasClass('is-active')){
                    fadeVideos($primary, $slide);
                } else {
                    console.log('didnt loop')
                }
                clearTimeout(loop);
            }, 7000);
        })
    }

    function withVideo($selector, callback){
        $selector.each(function(index, video){
            callback(video);
        })
    }

    function reEnter(){
        $('body').removeClass('is-loaded');
        goToSlide(4);
        setTimeout(function(){
            goToSlide(1);
            $('body').addClass('is-loaded');
        }, 2000);
    }
</script>
  
</body>

  
</html>